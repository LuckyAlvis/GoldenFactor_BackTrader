# è¿ç§»æŒ‡å—ï¼šä»æ—§ç‰ˆæœ¬åˆ°æ–°ç‰ˆæœ¬

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—å¸®åŠ©ä½ ä»æ—§ç‰ˆæœ¬çš„ç‰¹æ–¯æ‹‰æ•°æ®è·å–ä»£ç è¿ç§»åˆ°æ–°ç‰ˆæœ¬çš„é€šç”¨ç¾è‚¡æ•°æ®è·å–å™¨ã€‚

---

## ğŸ”„ ä»£ç å¯¹ç…§è¡¨

### åœºæ™¯1ï¼šåŸºç¡€æ•°æ®è·å–

#### æ—§ç‰ˆæœ¬
```python
# fetch_tesla_simple.py
import yfinance as yf
import pandas as pd

tsla = yf.Ticker("TSLA")
df = tsla.history(period='1y', interval='1d')
df.reset_index(inplace=True)
df.to_csv('tsla_data.csv', index=False)
```

#### æ–°ç‰ˆæœ¬
```python
# us_stock_data_fetcher.py
from us_stock_data_fetcher import USStockDataFetcher

fetcher = USStockDataFetcher('TSLA')
df = fetcher.fetch_historical_data(period='1y', interval='1d')
fetcher.save_to_csv('tsla_data.csv')
```

**æ”¹è¿›ç‚¹**ï¼š
- âœ… è‡ªåŠ¨å¤„ç†æ•°æ®æ ¼å¼
- âœ… è‡ªåŠ¨æ·»åŠ è‚¡ç¥¨ä»£ç åˆ—
- âœ… ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
- âœ… è¯¦ç»†çš„æ—¥å¿—è¾“å‡º

---

### åœºæ™¯2ï¼šè‡ªå®šä¹‰å‚æ•°

#### æ—§ç‰ˆæœ¬
```python
def fetch_tesla_historical_data(period='1y', interval='1d', save_path='tsla_historical.csv'):
    tsla = yf.Ticker("TSLA")
    df = tsla.history(period=period, interval=interval)
    df.reset_index(inplace=True)
    df.to_csv(save_path, index=False, encoding='utf-8-sig')
    return df

# ä½¿ç”¨
df = fetch_tesla_historical_data(period='6mo', interval='1d')
```

#### æ–°ç‰ˆæœ¬
```python
from us_stock_data_fetcher import USStockDataFetcher, Period, Interval

fetcher = USStockDataFetcher('TSLA')
df = fetcher.fetch_historical_data(
    period=Period.SIX_MONTHS,  # æˆ– '6mo'
    interval=Interval.ONE_DAY   # æˆ– '1d'
)
fetcher.save_to_csv()  # è‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶å
```

**æ”¹è¿›ç‚¹**ï¼š
- âœ… ç±»å‹å®‰å…¨ï¼ˆæšä¸¾ï¼‰
- âœ… è‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶å
- âœ… æ›´å¥½çš„ä»£ç æç¤º

---

### åœºæ™¯3ï¼šè·å–å®æ—¶æ•°æ®

#### æ—§ç‰ˆæœ¬
```python
def fetch_tesla_realtime_data(save_path='tsla_realtime.csv'):
    tsla = yf.Ticker("TSLA")
    info = tsla.info
    
    realtime_data = {
        'è‚¡ç¥¨ä»£ç ': 'TSLA',
        'å½“å‰ä»·æ ¼': info.get('currentPrice', 'N/A'),
        'å¸‚å€¼': info.get('marketCap', 'N/A'),
        # ... æ‰‹åŠ¨æå–æ¯ä¸ªå­—æ®µ
    }
    
    df = pd.DataFrame([realtime_data])
    df.to_csv(save_path, index=False)
    return realtime_data
```

#### æ–°ç‰ˆæœ¬
```python
from us_stock_data_fetcher import USStockDataFetcher

fetcher = USStockDataFetcher('TSLA')
info = fetcher.fetch_realtime_info()  # è‡ªåŠ¨æå–æ‰€æœ‰å…³é”®å­—æ®µ

# info æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«æ‰€æœ‰å®æ—¶æ•°æ®
print(f"å½“å‰ä»·æ ¼: ${info['current_price']}")
print(f"å¸‚å€¼: ${info['market_cap']:,}")
```

**æ”¹è¿›ç‚¹**ï¼š
- âœ… è‡ªåŠ¨æå–æ‰€æœ‰å…³é”®å­—æ®µ
- âœ… ç»Ÿä¸€çš„æ•°æ®ç»“æ„
- âœ… æ›´å¥½çš„é”™è¯¯å¤„ç†

---

### åœºæ™¯4ï¼šæ—¥å†…åˆ†é’Ÿæ•°æ®

#### æ—§ç‰ˆæœ¬
```python
def fetch_tesla_intraday_data(interval='1m', save_path='tsla_intraday.csv'):
    tsla = yf.Ticker("TSLA")
    df = tsla.history(period='7d', interval=interval)
    df.reset_index(inplace=True)
    df.to_csv(save_path, index=False)
    return df

# ä½¿ç”¨
df = fetch_tesla_intraday_data(interval='5m')
```

#### æ–°ç‰ˆæœ¬
```python
from us_stock_data_fetcher import USStockDataFetcher

fetcher = USStockDataFetcher('TSLA')
df = fetcher.fetch_historical_data(period='7d', interval='5m')
fetcher.save_to_csv('tsla_5min.csv')
```

**æ”¹è¿›ç‚¹**ï¼š
- âœ… ç»Ÿä¸€çš„æ¥å£
- âœ… è‡ªåŠ¨å¤„ç†åˆ—å
- âœ… æ›´å¥½çš„æ•°æ®éªŒè¯

---

### åœºæ™¯5ï¼šè¿ç»­è·å–å®æ—¶æ•°æ®

#### æ—§ç‰ˆæœ¬
```python
def continuous_fetch_realtime(interval_seconds=60, duration_minutes=10):
    tsla = yf.Ticker("TSLA")
    data_list = []
    
    end_time = datetime.now() + timedelta(minutes=duration_minutes)
    
    while datetime.now() < end_time:
        df = tsla.history(period='1d', interval='1m')
        latest = df.iloc[-1]
        
        data = {
            'æ—¶é—´': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
            'ä»·æ ¼': latest['Close'],
            'æˆäº¤é‡': latest['Volume']
        }
        data_list.append(data)
        
        time.sleep(interval_seconds)
    
    pd.DataFrame(data_list).to_csv('continuous.csv', index=False)
```

#### æ–°ç‰ˆæœ¬
```python
from us_stock_data_fetcher import USStockDataFetcher
import time

fetcher = USStockDataFetcher('TSLA', verbose=False)
data_list = []

for i in range(10):  # è·å–10æ¬¡
    df = fetcher.fetch_historical_data(period='1d', interval='1m')
    
    if df is not None and not df.empty:
        latest = df.iloc[-1]
        data_list.append({
            'time': datetime.now(),
            'price': latest['Close'],
            'volume': latest['Volume']
        })
    
    time.sleep(60)

# ä¿å­˜
pd.DataFrame(data_list).to_csv('continuous.csv', index=False)
```

**æ”¹è¿›ç‚¹**ï¼š
- âœ… æ›´æ¸…æ™°çš„é€»è¾‘
- âœ… æ›´å¥½çš„é”™è¯¯å¤„ç†
- âœ… å¯ä»¥å…³é—­è¯¦ç»†æ—¥å¿—

---

## ğŸ¯ åŠŸèƒ½æ˜ å°„è¡¨

| æ—§ç‰ˆæœ¬åŠŸèƒ½ | æ–°ç‰ˆæœ¬æ–¹æ³• | è¯´æ˜ |
|-----------|-----------|------|
| `fetch_tesla_historical_data()` | `fetch_historical_data()` | è·å–å†å²æ•°æ® |
| `fetch_tesla_realtime_data()` | `fetch_realtime_info()` | è·å–å®æ—¶ä¿¡æ¯ |
| `fetch_tesla_intraday_data()` | `fetch_historical_data()` | è·å–æ—¥å†…æ•°æ® |
| `continuous_fetch_realtime()` | å¾ªç¯è°ƒç”¨ `fetch_historical_data()` | è¿ç»­è·å– |
| `main()` | å‘½ä»¤è¡Œè¿è¡Œ | äº¤äº’å¼ç•Œé¢ |

---

## ğŸ†• æ–°å¢åŠŸèƒ½

### 1. æ”¯æŒä»»æ„è‚¡ç¥¨

```python
# æ—§ç‰ˆæœ¬ï¼šåªèƒ½è·å–ç‰¹æ–¯æ‹‰
# æ–°ç‰ˆæœ¬ï¼šæ”¯æŒä»»æ„è‚¡ç¥¨

fetcher = USStockDataFetcher('AAPL')   # è‹¹æœ
fetcher = USStockDataFetcher('MSFT')   # å¾®è½¯
fetcher = USStockDataFetcher('GOOGL')  # è°·æ­Œ
```

### 2. æ‰¹é‡è·å–

```python
# æ—§ç‰ˆæœ¬ï¼šä¸æ”¯æŒ
# æ–°ç‰ˆæœ¬ï¼šæ”¯æŒæ‰¹é‡è·å–

from us_stock_data_fetcher import BatchFetcher

batch = BatchFetcher(['TSLA', 'AAPL', 'MSFT'])
results = batch.fetch_all(period='1y', interval='1d')
```

### 3. å¤šç§è¾“å‡ºæ ¼å¼

```python
# æ—§ç‰ˆæœ¬ï¼šåªèƒ½ä¿å­˜CSV
# æ–°ç‰ˆæœ¬ï¼šæ”¯æŒå¤šç§æ ¼å¼

fetcher.save_to_csv('data.csv')
fetcher.save_to_sqlite('stocks.db', table_name='tsla')
fetcher.save_to_json('data.json')
df = fetcher.data  # ç›´æ¥è·å–DataFrame
```

### 4. æ•°æ®æ‘˜è¦

```python
# æ—§ç‰ˆæœ¬ï¼šéœ€è¦æ‰‹åŠ¨è®¡ç®—
# æ–°ç‰ˆæœ¬ï¼šè‡ªåŠ¨ç”Ÿæˆæ‘˜è¦

fetcher.print_summary()

# è¾“å‡ºï¼š
# æ•°æ®æ‘˜è¦ - TSLA
# æ€»è®°å½•æ•°: 250
# æœ€é«˜ä»·: $488.54
# æœ€ä½ä»·: $214.25
# å¹³å‡æ”¶ç›˜ä»·: $348.67
# ...
```

### 5. ç±»å‹å®‰å…¨

```python
# æ—§ç‰ˆæœ¬ï¼šä½¿ç”¨å­—ç¬¦ä¸²ï¼Œå®¹æ˜“æ‹¼å†™é”™è¯¯
period = '1y'
interval = '1d'

# æ–°ç‰ˆæœ¬ï¼šä½¿ç”¨æšä¸¾ï¼Œæœ‰IDEæç¤º
from us_stock_data_fetcher import Period, Interval

period = Period.ONE_YEAR
interval = Interval.ONE_DAY
```

---

## ğŸ“ è¿ç§»æ­¥éª¤

### æ­¥éª¤1ï¼šå®‰è£…ä¾èµ–ï¼ˆç›¸åŒï¼‰

```bash
pip3 install yfinance pandas
```

### æ­¥éª¤2ï¼šå¯¼å…¥æ–°æ¨¡å—

```python
# æ—§ç‰ˆæœ¬
import yfinance as yf
import pandas as pd

# æ–°ç‰ˆæœ¬
from us_stock_data_fetcher import USStockDataFetcher, Period, Interval, OutputFormat
```

### æ­¥éª¤3ï¼šæ›¿æ¢ä»£ç 

ä½¿ç”¨ä¸Šé¢çš„ä»£ç å¯¹ç…§è¡¨æ›¿æ¢ç›¸åº”çš„ä»£ç ã€‚

### æ­¥éª¤4ï¼šæµ‹è¯•

```python
# ç®€å•æµ‹è¯•
fetcher = USStockDataFetcher('TSLA')
df = fetcher.fetch_historical_data(period='1mo', interval='1d')

if df is not None and not df.empty:
    print("âœ… è¿ç§»æˆåŠŸ")
    fetcher.print_summary()
else:
    print("âŒ è¿ç§»å¤±è´¥")
```

---

## ğŸ”§ å¸¸è§è¿ç§»é—®é¢˜

### é—®é¢˜1ï¼šæ–‡ä»¶åä¸åŒ

**æ—§ç‰ˆæœ¬**ï¼š
```python
df.to_csv('tsla_data.csv', index=False)
```

**æ–°ç‰ˆæœ¬**ï¼š
```python
# æ–¹å¼1ï¼šæŒ‡å®šæ–‡ä»¶å
fetcher.save_to_csv('tsla_data.csv')

# æ–¹å¼2ï¼šè‡ªåŠ¨ç”Ÿæˆï¼ˆæ¨èï¼‰
fetcher.save_to_csv()  # ç”Ÿæˆï¼šTSLA_data_20251111_120000.csv
```

### é—®é¢˜2ï¼šåˆ—åä¸åŒ

**æ—§ç‰ˆæœ¬**ï¼š
```python
# yfinanceè¿”å›çš„åˆ—åå¯èƒ½åŒ…å«æ—¶åŒºä¿¡æ¯
# Date æˆ– Datetime
```

**æ–°ç‰ˆæœ¬**ï¼š
```python
# ç»Ÿä¸€ä¸º 'Date'
df['Date']  # æ€»æ˜¯å¯ç”¨
```

### é—®é¢˜3ï¼šéœ€è¦è·å–å…¶ä»–è‚¡ç¥¨

**æ—§ç‰ˆæœ¬**ï¼š
```python
# éœ€è¦ä¿®æ”¹ä»£ç ä¸­çš„ "TSLA"
tsla = yf.Ticker("TSLA")  # ç¡¬ç¼–ç 
```

**æ–°ç‰ˆæœ¬**ï¼š
```python
# ç›´æ¥ä¼ å‚
fetcher = USStockDataFetcher('AAPL')  # å‚æ•°åŒ–
```

### é—®é¢˜4ï¼šéœ€è¦æ‰¹é‡è·å–

**æ—§ç‰ˆæœ¬**ï¼š
```python
# éœ€è¦æ‰‹åŠ¨å¾ªç¯
symbols = ['TSLA', 'AAPL', 'MSFT']
for symbol in symbols:
    ticker = yf.Ticker(symbol)
    df = ticker.history(period='1y', interval='1d')
    df.to_csv(f'{symbol}_data.csv', index=False)
```

**æ–°ç‰ˆæœ¬**ï¼š
```python
# ä½¿ç”¨æ‰¹é‡è·å–å™¨
from us_stock_data_fetcher import BatchFetcher

batch = BatchFetcher(['TSLA', 'AAPL', 'MSFT'])
results = batch.fetch_all(period='1y', interval='1d')
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ä½¿ç”¨æšä¸¾ç±»å‹

```python
# âŒ ä¸æ¨èï¼šå®¹æ˜“æ‹¼å†™é”™è¯¯
fetcher.fetch_historical_data(period='1y', interval='1d')

# âœ… æ¨èï¼šç±»å‹å®‰å…¨ï¼Œæœ‰IDEæç¤º
from us_stock_data_fetcher import Period, Interval

fetcher.fetch_historical_data(
    period=Period.ONE_YEAR,
    interval=Interval.ONE_DAY
)
```

### 2. ä½¿ç”¨è‡ªåŠ¨æ–‡ä»¶å

```python
# âŒ ä¸æ¨èï¼šå›ºå®šæ–‡ä»¶åå®¹æ˜“è¦†ç›–
fetcher.save_to_csv('data.csv')

# âœ… æ¨èï¼šè‡ªåŠ¨ç”Ÿæˆæ—¶é—´æˆ³
fetcher.save_to_csv()  # TSLA_data_20251111_120000.csv
```

### 3. éªŒè¯æ•°æ®

```python
# âœ… æ¨èï¼šæ€»æ˜¯éªŒè¯æ•°æ®
df = fetcher.fetch_historical_data(period='1y', interval='1d')

if df is not None and not df.empty:
    # ç»§ç»­å¤„ç†
    fetcher.save_to_csv()
else:
    print("æ•°æ®è·å–å¤±è´¥")
```

### 4. ä½¿ç”¨æ•°æ®æ‘˜è¦

```python
# âœ… æ¨èï¼šä½¿ç”¨å†…ç½®çš„æ‘˜è¦åŠŸèƒ½
fetcher.print_summary()

# è€Œä¸æ˜¯æ‰‹åŠ¨è®¡ç®—
# print(f"æœ€é«˜ä»·: {df['High'].max()}")
# print(f"æœ€ä½ä»·: {df['Low'].min()}")
# ...
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ | æ”¹è¿› |
|------|--------|--------|------|
| ä»£ç è¡Œæ•° | ~300è¡Œ | ~600è¡Œ | åŠŸèƒ½æ›´ä¸°å¯Œ |
| è·å–é€Ÿåº¦ | ç›¸åŒ | ç›¸åŒ | åº•å±‚APIç›¸åŒ |
| é”™è¯¯å¤„ç† | åŸºç¡€ | å®Œå–„ | âœ… |
| ç±»å‹å®‰å…¨ | æ—  | æœ‰ | âœ… |
| å¯ç»´æŠ¤æ€§ | ä¸­ | é«˜ | âœ… |
| å¯æ‰©å±•æ€§ | ä½ | é«˜ | âœ… |

---

## ğŸ¯ è¿ç§»æ£€æŸ¥æ¸…å•

- [ ] å®‰è£…ä¾èµ–
- [ ] å¯¼å…¥æ–°æ¨¡å—
- [ ] æ›¿æ¢æ•°æ®è·å–ä»£ç 
- [ ] æ›¿æ¢ä¿å­˜ä»£ç 
- [ ] æ·»åŠ æ•°æ®éªŒè¯
- [ ] æµ‹è¯•åŸºæœ¬åŠŸèƒ½
- [ ] æµ‹è¯•è¾¹ç•Œæƒ…å†µ
- [ ] æ›´æ–°æ–‡æ¡£
- [ ] æ›´æ–°æµ‹è¯•ç”¨ä¾‹

---

## ğŸ“š å‚è€ƒèµ„æº

- **æ–°ç‰ˆæœ¬æ–‡æ¡£**ï¼š`ç¾è‚¡æ•°æ®è·å–å™¨ä½¿ç”¨æ‰‹å†Œ.md`
- **ä½¿ç”¨ç¤ºä¾‹**ï¼š`us_stock_examples.py`
- **å¯¹æ¯”è¯´æ˜**ï¼š`README_ç¾è‚¡æ•°æ®è·å–å™¨.md`

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœåœ¨è¿ç§»è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ `ç¾è‚¡æ•°æ®è·å–å™¨ä½¿ç”¨æ‰‹å†Œ.md` çš„å¸¸è§é—®é¢˜éƒ¨åˆ†
2. è¿è¡Œ `us_stock_examples.py` æŸ¥çœ‹ç¤ºä¾‹
3. å¯¹æ¯”æ—§ç‰ˆæœ¬å’Œæ–°ç‰ˆæœ¬çš„ä»£ç 

---

**ç‰ˆæœ¬**ï¼šv2.0  
**æ›´æ–°æ—¶é—´**ï¼š2025å¹´11æœˆ  
**ä½œè€…**ï¼šIvan
