# ç¾è‚¡æ•°æ®è·å–å™¨ä½¿ç”¨æ‰‹å†Œ v2.0

## ğŸ“‹ ç›®å½•

- [ç®€ä»‹](#ç®€ä»‹)
- [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [APIæ–‡æ¡£](#apiæ–‡æ¡£)
- [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
- [å‚æ•°è¯´æ˜](#å‚æ•°è¯´æ˜)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ç®€ä»‹

`us_stock_data_fetcher.py` æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç¾è‚¡æ•°æ®è·å–å·¥å…·ï¼Œæä¾›äº†ç»Ÿä¸€ã€ç®€æ´çš„APIæ¥è·å–ä»»æ„ç¾è‚¡çš„å†å²æ•°æ®å’Œå®æ—¶ä¿¡æ¯ã€‚

### ä¸æ—§ç‰ˆæœ¬å¯¹æ¯”

| ç‰¹æ€§ | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ v2.0 |
|------|--------|-------------|
| è‚¡ç¥¨ä»£ç  | ç¡¬ç¼–ç TSLA | âœ… æ”¯æŒä»»æ„è‚¡ç¥¨ |
| æ—¶é—´å‘¨æœŸ | å›ºå®š1å¹´ | âœ… 11ç§å‘¨æœŸå¯é€‰ |
| Kçº¿ç±»å‹ | å›ºå®šæ—¥çº¿ | âœ… 13ç§ç±»å‹å¯é€‰ |
| è¾“å‡ºæ ¼å¼ | ä»…CSV | âœ… CSV/SQLite/JSON/DataFrame |
| æ‰¹é‡è·å– | ä¸æ”¯æŒ | âœ… æ”¯æŒæ‰¹é‡è·å– |
| å‚æ•°ä¼ é€’ | æ—  | âœ… å‘½ä»¤è¡Œ+APIä¸¤ç§æ–¹å¼ |
| é”™è¯¯å¤„ç† | åŸºç¡€ | âœ… å®Œå–„çš„å¼‚å¸¸å¤„ç† |
| ä»£ç ç»“æ„ | å‡½æ•°å¼ | âœ… é¢å‘å¯¹è±¡è®¾è®¡ |
| ç±»å‹å®‰å…¨ | æ—  | âœ… æšä¸¾ç±»å‹æ”¯æŒ |
| æ–‡ä»¶å‘½å | å›ºå®š | âœ… è‡ªåŠ¨ç”Ÿæˆæ—¶é—´æˆ³ |

---

## æ ¸å¿ƒç‰¹æ€§

### 1. çµæ´»çš„å‚æ•°é…ç½®

```python
# æ”¯æŒä»»æ„è‚¡ç¥¨ä»£ç 
fetcher = USStockDataFetcher('TSLA')  # ç‰¹æ–¯æ‹‰
fetcher = USStockDataFetcher('AAPL')  # è‹¹æœ
fetcher = USStockDataFetcher('MSFT')  # å¾®è½¯

# æ”¯æŒå¤šç§æ—¶é—´å‘¨æœŸ
period='1d'    # 1å¤©
period='1mo'   # 1ä¸ªæœˆ
period='1y'    # 1å¹´
period='5y'    # 5å¹´
period='max'   # æ‰€æœ‰å†å²

# æ”¯æŒå¤šç§Kçº¿ç±»å‹
interval='1m'   # 1åˆ†é’Ÿ
interval='5m'   # 5åˆ†é’Ÿ
interval='1h'   # 1å°æ—¶
interval='1d'   # 1å¤©
interval='1wk'  # 1å‘¨
interval='1mo'  # 1æœˆ

# æ”¯æŒè‡ªå®šä¹‰æ—¥æœŸèŒƒå›´
start_date='2024-01-01'
end_date='2024-12-31'
```

### 2. å¤šç§è¾“å‡ºæ ¼å¼

```python
# CSVæ–‡ä»¶
fetcher.save_to_csv('output.csv')

# SQLiteæ•°æ®åº“
fetcher.save_to_sqlite('stocks.db', table_name='tsla')

# JSONæ–‡ä»¶
fetcher.save_to_json('output.json')

# DataFrameå¯¹è±¡ï¼ˆç”¨äºè¿›ä¸€æ­¥åˆ†æï¼‰
df = fetcher.data
```

### 3. æ‰¹é‡è·å–

```python
# ä¸€æ¬¡è·å–å¤šåªè‚¡ç¥¨
batch = BatchFetcher(['TSLA', 'AAPL', 'MSFT'])
results = batch.fetch_all(period='1y', interval='1d')
```

### 4. ç±»å‹å®‰å…¨

```python
from us_stock_data_fetcher import Period, Interval, OutputFormat

# ä½¿ç”¨æšä¸¾é¿å…æ‹¼å†™é”™è¯¯
fetcher.fetch_historical_data(
    period=Period.ONE_YEAR,
    interval=Interval.ONE_DAY
)

fetcher.save(OutputFormat.CSV)
```

---

## å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pip3 install yfinance pandas
```

### æ–¹å¼1ï¼šå‘½ä»¤è¡Œäº¤äº’

```bash
python3 us_stock_data_fetcher.py
```

æŒ‰ç…§æç¤ºè¾“å…¥ï¼š
1. è‚¡ç¥¨ä»£ç ï¼ˆå¦‚ï¼šTSLAï¼‰
2. æ—¶é—´å‘¨æœŸï¼ˆå¦‚ï¼š1å¹´ï¼‰
3. Kçº¿ç±»å‹ï¼ˆå¦‚ï¼š1å¤©ï¼‰
4. è¾“å‡ºæ ¼å¼ï¼ˆå¦‚ï¼šCSVï¼‰

### æ–¹å¼2ï¼šPython API

```python
from us_stock_data_fetcher import USStockDataFetcher

# åˆ›å»ºè·å–å™¨
fetcher = USStockDataFetcher('TSLA')

# è·å–æ•°æ®
df = fetcher.fetch_historical_data(period='1y', interval='1d')

# ä¿å­˜æ•°æ®
fetcher.save_to_csv('tsla_data.csv')

# æ‰“å°æ‘˜è¦
fetcher.print_summary()
```

---

## APIæ–‡æ¡£

### USStockDataFetcher ç±»

#### åˆå§‹åŒ–

```python
fetcher = USStockDataFetcher(symbol: str, verbose: bool = True)
```

**å‚æ•°**ï¼š
- `symbol`: è‚¡ç¥¨ä»£ç ï¼ˆå¦‚ï¼š'TSLA', 'AAPL'ï¼‰
- `verbose`: æ˜¯å¦æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ˆé»˜è®¤Trueï¼‰

#### è·å–å†å²æ•°æ®

```python
df = fetcher.fetch_historical_data(
    period: Union[str, Period] = Period.ONE_YEAR,
    interval: Union[str, Interval] = Interval.ONE_DAY,
    start_date: Optional[str] = None,
    end_date: Optional[str] = None
) -> pd.DataFrame
```

**å‚æ•°**ï¼š
- `period`: æ—¶é—´å‘¨æœŸï¼ˆ'1d', '1mo', '1y', '5y', 'max'ç­‰ï¼‰
- `interval`: Kçº¿ç±»å‹ï¼ˆ'1m', '5m', '1h', '1d', '1wk'ç­‰ï¼‰
- `start_date`: å¼€å§‹æ—¥æœŸï¼ˆæ ¼å¼ï¼š'YYYY-MM-DD'ï¼‰
- `end_date`: ç»“æŸæ—¥æœŸï¼ˆæ ¼å¼ï¼š'YYYY-MM-DD'ï¼‰

**è¿”å›**ï¼š
- DataFrameå¯¹è±¡ï¼ŒåŒ…å«OHLCVæ•°æ®

**æ³¨æ„**ï¼š
- å¦‚æœæŒ‡å®šäº†`start_date`å’Œ`end_date`ï¼Œåˆ™`period`å‚æ•°æ— æ•ˆ
- åˆ†é’Ÿçº§æ•°æ®ä»…æ”¯æŒæœ€è¿‘7å¤©

#### è·å–å®æ—¶ä¿¡æ¯

```python
info = fetcher.fetch_realtime_info() -> Dict
```

**è¿”å›**ï¼š
- åŒ…å«å®æ—¶æ•°æ®çš„å­—å…¸ï¼š
  - `current_price`: å½“å‰ä»·æ ¼
  - `market_cap`: å¸‚å€¼
  - `pe_ratio`: å¸‚ç›ˆç‡
  - `week_52_high`: 52å‘¨æœ€é«˜
  - `week_52_low`: 52å‘¨æœ€ä½
  - ç­‰ç­‰...

#### ä¿å­˜æ•°æ®

```python
# ä¿å­˜ä¸ºCSV
path = fetcher.save_to_csv(
    output_path: Optional[str] = None,
    include_symbol: bool = True
) -> str

# ä¿å­˜åˆ°SQLite
success = fetcher.save_to_sqlite(
    db_path: str = 'us_stock_data.db',
    table_name: Optional[str] = None,
    if_exists: str = 'replace'
) -> bool

# ä¿å­˜ä¸ºJSON
path = fetcher.save_to_json(
    output_path: Optional[str] = None,
    orient: str = 'records'
) -> str

# ç»Ÿä¸€ä¿å­˜æ¥å£
result = fetcher.save(
    output_format: Union[str, OutputFormat],
    output_path: Optional[str] = None,
    **kwargs
) -> Union[str, bool]
```

#### æ•°æ®æ‘˜è¦

```python
# è·å–æ‘˜è¦ä¿¡æ¯
summary = fetcher.get_data_summary() -> Dict

# æ‰“å°æ‘˜è¦
fetcher.print_summary()
```

### BatchFetcher ç±»

#### åˆå§‹åŒ–

```python
batch = BatchFetcher(symbols: List[str], verbose: bool = True)
```

#### æ‰¹é‡è·å–

```python
results = batch.fetch_all(
    period: Union[str, Period] = Period.ONE_YEAR,
    interval: Union[str, Interval] = Interval.ONE_DAY,
    output_format: Union[str, OutputFormat] = OutputFormat.CSV,
    output_dir: str = 'batch_data'
) -> Dict[str, pd.DataFrame]
```

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šåŸºç¡€ä½¿ç”¨

```python
from us_stock_data_fetcher import USStockDataFetcher

# è·å–ç‰¹æ–¯æ‹‰1å¹´æ—¥çº¿æ•°æ®
fetcher = USStockDataFetcher('TSLA')
df = fetcher.fetch_historical_data(period='1y', interval='1d')
fetcher.save_to_csv('tsla_1y_daily.csv')
fetcher.print_summary()
```

### ç¤ºä¾‹2ï¼šè‡ªå®šä¹‰æ—¥æœŸèŒƒå›´

```python
# è·å–2024å¹´å…¨å¹´æ•°æ®
fetcher = USStockDataFetcher('AAPL')
df = fetcher.fetch_historical_data(
    start_date='2024-01-01',
    end_date='2024-12-31',
    interval='1d'
)
```

### ç¤ºä¾‹3ï¼šæ—¥å†…åˆ†é’Ÿæ•°æ®

```python
# è·å–æœ€è¿‘7å¤©çš„5åˆ†é’Ÿæ•°æ®
fetcher = USStockDataFetcher('NVDA')
df = fetcher.fetch_historical_data(period='7d', interval='5m')
fetcher.save_to_csv('nvda_5min.csv')
```

### ç¤ºä¾‹4ï¼šå¤šç§è¾“å‡ºæ ¼å¼

```python
fetcher = USStockDataFetcher('MSFT')
df = fetcher.fetch_historical_data(period='6mo', interval='1d')

# åŒæ—¶ä¿å­˜ä¸ºå¤šç§æ ¼å¼
fetcher.save_to_csv('msft_data.csv')
fetcher.save_to_sqlite('stocks.db', table_name='msft_daily')
fetcher.save_to_json('msft_data.json')
```

### ç¤ºä¾‹5ï¼šè·å–å®æ—¶ä¿¡æ¯

```python
fetcher = USStockDataFetcher('GOOGL')
info = fetcher.fetch_realtime_info()

print(f"å½“å‰ä»·æ ¼: ${info['current_price']}")
print(f"å¸‚å€¼: ${info['market_cap']:,}")
print(f"æ¶¨è·Œå¹…: {info['change_percent']}%")
```

### ç¤ºä¾‹6ï¼šæ‰¹é‡è·å–

```python
from us_stock_data_fetcher import BatchFetcher

# æ‰¹é‡è·å–ç§‘æŠ€è‚¡æ•°æ®
tech_stocks = ['TSLA', 'AAPL', 'MSFT', 'GOOGL', 'NVDA']
batch = BatchFetcher(tech_stocks)

results = batch.fetch_all(
    period='3mo',
    interval='1d',
    output_format='csv',
    output_dir='tech_stocks_data'
)

print(f"æˆåŠŸè·å– {len(results)} åªè‚¡ç¥¨çš„æ•°æ®")
```

### ç¤ºä¾‹7ï¼šä½¿ç”¨æšä¸¾ç±»å‹

```python
from us_stock_data_fetcher import Period, Interval, OutputFormat

fetcher = USStockDataFetcher('AMZN')

# ä½¿ç”¨æšä¸¾ç±»å‹ï¼ˆæ›´å®‰å…¨ï¼Œæœ‰IDEæç¤ºï¼‰
df = fetcher.fetch_historical_data(
    period=Period.TWO_YEARS,
    interval=Interval.ONE_WEEK
)

fetcher.save(OutputFormat.CSV, 'amzn_weekly.csv')
```

### ç¤ºä¾‹8ï¼šæ•°æ®åˆ†æ

```python
fetcher = USStockDataFetcher('TSLA', verbose=False)
df = fetcher.fetch_historical_data(period='1y', interval='1d')

# è®¡ç®—æŠ€æœ¯æŒ‡æ ‡
df['Returns'] = df['Close'].pct_change()
df['MA20'] = df['Close'].rolling(window=20).mean()
df['MA60'] = df['Close'].rolling(window=60).mean()

# ç»Ÿè®¡åˆ†æ
print(f"å¹³å‡æ”¶ç›˜ä»·: ${df['Close'].mean():.2f}")
print(f"ä»·æ ¼æ³¢åŠ¨ç‡: {df['Returns'].std() * 100:.2f}%")
print(f"æœ€å¤§å•æ—¥æ¶¨å¹…: {df['Returns'].max() * 100:.2f}%")

# ä¿å­˜åˆ†æç»“æœ
df.to_csv('tsla_analysis.csv', index=False)
```

### ç¤ºä¾‹9ï¼šæ•°æ®åº“æ“ä½œ

```python
import sqlite3

# å°†å¤šåªè‚¡ç¥¨ä¿å­˜åˆ°åŒä¸€ä¸ªæ•°æ®åº“
symbols = ['TSLA', 'AAPL', 'MSFT']

for symbol in symbols:
    fetcher = USStockDataFetcher(symbol, verbose=False)
    df = fetcher.fetch_historical_data(period='1mo', interval='1d')
    
    fetcher.save_to_sqlite(
        db_path='portfolio.db',
        table_name=f'stock_{symbol.lower()}',
        if_exists='replace'
    )

# æŸ¥è¯¢æ•°æ®åº“
conn = sqlite3.connect('portfolio.db')
df = pd.read_sql_query("SELECT * FROM stock_tsla", conn)
conn.close()
```

### ç¤ºä¾‹10ï¼šé”™è¯¯å¤„ç†

```python
# å¤„ç†ä¸å­˜åœ¨çš„è‚¡ç¥¨
fetcher = USStockDataFetcher('INVALID_SYMBOL')
df = fetcher.fetch_historical_data(period='1y', interval='1d')

if df is None or df.empty:
    print("è·å–å¤±è´¥ï¼Œè¯·æ£€æŸ¥è‚¡ç¥¨ä»£ç ")

# å¤„ç†ä¸åˆç†çš„å‚æ•°ç»„åˆ
fetcher = USStockDataFetcher('TSLA')
df = fetcher.fetch_historical_data(period='1y', interval='1m')  # 1åˆ†é’Ÿæ•°æ®ä¸æ”¯æŒ1å¹´

if df is None or df.empty:
    # è°ƒæ•´ä¸ºåˆç†å‚æ•°
    df = fetcher.fetch_historical_data(period='7d', interval='1m')
```

---

## å‚æ•°è¯´æ˜

### æ—¶é—´å‘¨æœŸï¼ˆPeriodï¼‰

| å€¼ | è¯´æ˜ | æšä¸¾ |
|----|------|------|
| '1d' | 1å¤© | Period.ONE_DAY |
| '5d' | 5å¤© | Period.FIVE_DAYS |
| '1mo' | 1ä¸ªæœˆ | Period.ONE_MONTH |
| '3mo' | 3ä¸ªæœˆ | Period.THREE_MONTHS |
| '6mo' | 6ä¸ªæœˆ | Period.SIX_MONTHS |
| '1y' | 1å¹´ | Period.ONE_YEAR |
| '2y' | 2å¹´ | Period.TWO_YEARS |
| '5y' | 5å¹´ | Period.FIVE_YEARS |
| '10y' | 10å¹´ | Period.TEN_YEARS |
| 'ytd' | å¹´åˆè‡³ä»Š | Period.YTD |
| 'max' | æ‰€æœ‰å†å² | Period.MAX |

### Kçº¿ç±»å‹ï¼ˆIntervalï¼‰

| å€¼ | è¯´æ˜ | é™åˆ¶ | æšä¸¾ |
|----|------|------|------|
| '1m' | 1åˆ†é’Ÿ | ä»…æœ€è¿‘7å¤© | Interval.ONE_MINUTE |
| '2m' | 2åˆ†é’Ÿ | ä»…æœ€è¿‘60å¤© | Interval.TWO_MINUTES |
| '5m' | 5åˆ†é’Ÿ | ä»…æœ€è¿‘60å¤© | Interval.FIVE_MINUTES |
| '15m' | 15åˆ†é’Ÿ | ä»…æœ€è¿‘60å¤© | Interval.FIFTEEN_MINUTES |
| '30m' | 30åˆ†é’Ÿ | ä»…æœ€è¿‘60å¤© | Interval.THIRTY_MINUTES |
| '60m' | 60åˆ†é’Ÿ | ä»…æœ€è¿‘730å¤© | Interval.SIXTY_MINUTES |
| '90m' | 90åˆ†é’Ÿ | ä»…æœ€è¿‘60å¤© | Interval.NINETY_MINUTES |
| '1h' | 1å°æ—¶ | ä»…æœ€è¿‘730å¤© | Interval.ONE_HOUR |
| '1d' | 1å¤© | æ— é™åˆ¶ | Interval.ONE_DAY |
| '5d' | 5å¤© | æ— é™åˆ¶ | Interval.FIVE_DAYS |
| '1wk' | 1å‘¨ | æ— é™åˆ¶ | Interval.ONE_WEEK |
| '1mo' | 1æœˆ | æ— é™åˆ¶ | Interval.ONE_MONTH |
| '3mo' | 3æœˆ | æ— é™åˆ¶ | Interval.THREE_MONTHS |

### è¾“å‡ºæ ¼å¼ï¼ˆOutputFormatï¼‰

| å€¼ | è¯´æ˜ | æšä¸¾ |
|----|------|------|
| 'csv' | CSVæ–‡ä»¶ | OutputFormat.CSV |
| 'sqlite' | SQLiteæ•°æ®åº“ | OutputFormat.SQLITE |
| 'json' | JSONæ–‡ä»¶ | OutputFormat.JSON |
| 'dataframe' | DataFrameå¯¹è±¡ | OutputFormat.DATAFRAME |

### æ•°æ®åº“if_existså‚æ•°

| å€¼ | è¯´æ˜ |
|----|------|
| 'fail' | å¦‚æœè¡¨å­˜åœ¨åˆ™æŠ¥é”™ |
| 'replace' | å¦‚æœè¡¨å­˜åœ¨åˆ™æ›¿æ¢ï¼ˆé»˜è®¤ï¼‰ |
| 'append' | å¦‚æœè¡¨å­˜åœ¨åˆ™è¿½åŠ  |

---

## æœ€ä½³å®è·µ

### 1. é€‰æ‹©åˆé€‚çš„æ—¶é—´å‘¨æœŸå’ŒKçº¿ç±»å‹

```python
# âœ… æ¨èï¼šæ—¥çº¿æ•°æ®è·å–1å¹´
fetcher.fetch_historical_data(period='1y', interval='1d')

# âœ… æ¨èï¼šåˆ†é’Ÿæ•°æ®è·å–7å¤©
fetcher.fetch_historical_data(period='7d', interval='5m')

# âŒ ä¸æ¨èï¼šåˆ†é’Ÿæ•°æ®è·å–1å¹´ï¼ˆä¼šå¤±è´¥ï¼‰
fetcher.fetch_historical_data(period='1y', interval='1m')
```

### 2. ä½¿ç”¨æšä¸¾ç±»å‹

```python
# âœ… æ¨èï¼šä½¿ç”¨æšä¸¾ï¼ˆæœ‰IDEæç¤ºï¼Œé¿å…æ‹¼å†™é”™è¯¯ï¼‰
from us_stock_data_fetcher import Period, Interval

fetcher.fetch_historical_data(
    period=Period.ONE_YEAR,
    interval=Interval.ONE_DAY
)

# âŒ ä¸æ¨èï¼šä½¿ç”¨å­—ç¬¦ä¸²ï¼ˆå®¹æ˜“æ‹¼å†™é”™è¯¯ï¼‰
fetcher.fetch_historical_data(period='1y', interval='1d')
```

### 3. æ‰¹é‡è·å–æ—¶å…³é—­è¯¦ç»†æ—¥å¿—

```python
# âœ… æ¨èï¼šæ‰¹é‡è·å–æ—¶å…³é—­verbose
batch = BatchFetcher(symbols, verbose=False)

# âŒ ä¸æ¨èï¼šæ‰¹é‡è·å–æ—¶å¼€å¯verboseï¼ˆè¾“å‡ºå¤ªå¤šï¼‰
batch = BatchFetcher(symbols, verbose=True)
```

### 4. æ•°æ®éªŒè¯

```python
# âœ… æ¨èï¼šéªŒè¯æ•°æ®
df = fetcher.fetch_historical_data(period='1y', interval='1d')

if df is not None and not df.empty:
    print(f"è·å–æˆåŠŸ: {len(df)} æ¡æ•°æ®")
    # ç»§ç»­å¤„ç†...
else:
    print("è·å–å¤±è´¥")
```

### 5. æ–‡ä»¶å‘½å

```python
# âœ… æ¨èï¼šè®©ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„æ–‡ä»¶å
fetcher.save_to_csv()  # è‡ªåŠ¨ç”Ÿæˆï¼šTSLA_data_20251111_120000.csv

# âœ… æ¨èï¼šä½¿ç”¨æœ‰æ„ä¹‰çš„æ–‡ä»¶å
fetcher.save_to_csv('tsla_daily_2024.csv')

# âŒ ä¸æ¨èï¼šä½¿ç”¨é€šç”¨æ–‡ä»¶åï¼ˆå®¹æ˜“è¦†ç›–ï¼‰
fetcher.save_to_csv('data.csv')
```

### 6. æ•°æ®åº“ä½¿ç”¨

```python
# âœ… æ¨èï¼šä½¿ç”¨æœ‰æ„ä¹‰çš„è¡¨å
fetcher.save_to_sqlite('stocks.db', table_name='tsla_daily')

# âœ… æ¨èï¼šä½¿ç”¨appendæ¨¡å¼è¿½åŠ æ•°æ®
fetcher.save_to_sqlite('stocks.db', table_name='tsla_daily', if_exists='append')

# âŒ ä¸æ¨èï¼šä½¿ç”¨é»˜è®¤è¡¨åï¼ˆä¸ç›´è§‚ï¼‰
fetcher.save_to_sqlite('stocks.db')
```

---

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆåˆ†é’Ÿæ•°æ®åªèƒ½è·å–æœ€è¿‘7å¤©ï¼Ÿ

**A**: è¿™æ˜¯yfinanceï¼ˆYahoo Finance APIï¼‰çš„é™åˆ¶ã€‚å…è´¹APIå¯¹åˆ†é’Ÿçº§æ•°æ®æœ‰æ—¶é—´é™åˆ¶ï¼š
- 1åˆ†é’Ÿæ•°æ®ï¼šæœ€è¿‘7å¤©
- 2-90åˆ†é’Ÿæ•°æ®ï¼šæœ€è¿‘60å¤©
- å°æ—¶æ•°æ®ï¼šæœ€è¿‘730å¤©

### Q2: å¦‚ä½•è·å–æ›´é•¿æ—¶é—´çš„åˆ†é’Ÿæ•°æ®ï¼Ÿ

**A**: å¯ä»¥åˆ†æ‰¹è·å–å¹¶åˆå¹¶ï¼š

```python
from datetime import datetime, timedelta
import pandas as pd

all_data = []
end_date = datetime.now()

for i in range(4):  # è·å–4å‘¨æ•°æ®
    start_date = end_date - timedelta(days=7)
    
    fetcher = USStockDataFetcher('TSLA', verbose=False)
    df = fetcher.fetch_historical_data(
        start_date=start_date.strftime('%Y-%m-%d'),
        end_date=end_date.strftime('%Y-%m-%d'),
        interval='5m'
    )
    
    if df is not None:
        all_data.append(df)
    
    end_date = start_date

# åˆå¹¶æ‰€æœ‰æ•°æ®
combined_df = pd.concat(all_data, ignore_index=True)
```

### Q3: æ•°æ®æœ‰å»¶è¿Ÿå—ï¼Ÿ

**A**: å…è´¹çš„Yahoo Finance APIæ•°æ®æœ‰15-20åˆ†é’Ÿå»¶è¿Ÿã€‚å¦‚éœ€å®æ—¶æ•°æ®ï¼Œå»ºè®®ä½¿ç”¨ä»˜è´¹APIã€‚

### Q4: å¦‚ä½•å¤„ç†ç½‘ç»œé”™è¯¯ï¼Ÿ

**A**: æ·»åŠ é‡è¯•æœºåˆ¶ï¼š

```python
import time

def fetch_with_retry(symbol, max_retries=3):
    for i in range(max_retries):
        try:
            fetcher = USStockDataFetcher(symbol)
            df = fetcher.fetch_historical_data(period='1y', interval='1d')
            
            if df is not None and not df.empty:
                return df
        except Exception as e:
            print(f"å°è¯• {i+1}/{max_retries} å¤±è´¥: {e}")
            time.sleep(2)  # ç­‰å¾…2ç§’åé‡è¯•
    
    return None
```

### Q5: å¦‚ä½•è·å–æ¸¯è‚¡æˆ–Aè‚¡æ•°æ®ï¼Ÿ

**A**: yfinanceæ”¯æŒå…¨çƒå¸‚åœºï¼Œåªéœ€ä½¿ç”¨æ­£ç¡®çš„è‚¡ç¥¨ä»£ç ï¼š

```python
# æ¸¯è‚¡ï¼ˆéœ€è¦åŠ .HKåç¼€ï¼‰
fetcher = USStockDataFetcher('0700.HK')  # è…¾è®¯

# Aè‚¡ï¼ˆéœ€è¦åŠ .SSæˆ–.SZåç¼€ï¼‰
fetcher = USStockDataFetcher('600519.SS')  # è´µå·èŒ…å°ï¼ˆä¸Šäº¤æ‰€ï¼‰
fetcher = USStockDataFetcher('000001.SZ')  # å¹³å®‰é“¶è¡Œï¼ˆæ·±äº¤æ‰€ï¼‰
```

### Q6: æ•°æ®åŒ…å«å“ªäº›å­—æ®µï¼Ÿ

**A**: æ ‡å‡†OHLCVæ•°æ®ï¼š

| å­—æ®µ | è¯´æ˜ |
|------|------|
| Symbol | è‚¡ç¥¨ä»£ç  |
| Date | æ—¥æœŸæ—¶é—´ |
| Open | å¼€ç›˜ä»· |
| High | æœ€é«˜ä»· |
| Low | æœ€ä½ä»· |
| Close | æ”¶ç›˜ä»· |
| Volume | æˆäº¤é‡ |
| Dividends | è‚¡æ¯ï¼ˆå¦‚æœ‰ï¼‰ |
| Stock Splits | è‚¡ç¥¨æ‹†åˆ†ï¼ˆå¦‚æœ‰ï¼‰ |

### Q7: å¦‚ä½•å¤„ç†æ—¶åŒºé—®é¢˜ï¼Ÿ

**A**: yfinanceè¿”å›çš„æ•°æ®åŒ…å«æ—¶åŒºä¿¡æ¯ï¼ˆé€šå¸¸æ˜¯ç¾å›½ä¸œéƒ¨æ—¶é—´ï¼‰ã€‚å¦‚éœ€è½¬æ¢ï¼š

```python
df = fetcher.fetch_historical_data(period='1y', interval='1d')

# è½¬æ¢ä¸ºæœ¬åœ°æ—¶åŒº
df['Date'] = pd.to_datetime(df['Date']).dt.tz_convert('Asia/Shanghai')

# æˆ–ç§»é™¤æ—¶åŒºä¿¡æ¯
df['Date'] = pd.to_datetime(df['Date']).dt.tz_localize(None)
```

### Q8: å¯ä»¥è·å–æœŸæƒæ•°æ®å—ï¼Ÿ

**A**: å½“å‰ç‰ˆæœ¬ä¸ç›´æ¥æ”¯æŒï¼Œä½†å¯ä»¥é€šè¿‡yfinanceçš„tickerå¯¹è±¡è·å–ï¼š

```python
fetcher = USStockDataFetcher('TSLA')
fetcher._init_ticker()

# è·å–æœŸæƒåˆ°æœŸæ—¥
print(fetcher.ticker.options)

# è·å–ç‰¹å®šåˆ°æœŸæ—¥çš„æœŸæƒé“¾
opt = fetcher.ticker.option_chain('2025-12-19')
print(opt.calls)  # çœ‹æ¶¨æœŸæƒ
print(opt.puts)   # çœ‹è·ŒæœŸæƒ
```

---

## ç‰ˆæœ¬å†å²

### v2.0 (2025-11)
- âœ… å®Œå…¨é‡æ„ï¼Œé¢å‘å¯¹è±¡è®¾è®¡
- âœ… æ”¯æŒä»»æ„è‚¡ç¥¨ä»£ç 
- âœ… æ”¯æŒ11ç§æ—¶é—´å‘¨æœŸ
- âœ… æ”¯æŒ13ç§Kçº¿ç±»å‹
- âœ… æ”¯æŒ4ç§è¾“å‡ºæ ¼å¼
- âœ… æ–°å¢æ‰¹é‡è·å–åŠŸèƒ½
- âœ… æ–°å¢æšä¸¾ç±»å‹æ”¯æŒ
- âœ… æ–°å¢æ•°æ®æ‘˜è¦åŠŸèƒ½
- âœ… å®Œå–„é”™è¯¯å¤„ç†
- âœ… è‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶å

### v1.0 (2025-11)
- åŸºç¡€ç‰ˆæœ¬ï¼Œä»…æ”¯æŒç‰¹æ–¯æ‹‰
- å›ºå®šå‚æ•°
- ä»…CSVè¾“å‡º

---

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åé¦ˆï¼

---

**æœ€åæ›´æ–°**ï¼š2025å¹´11æœˆ  
**ç‰ˆæœ¬**ï¼šv2.0  
**ä½œè€…**ï¼šIvan

**å…è´£å£°æ˜**ï¼šæœ¬å·¥å…·ä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚è‚¡å¸‚æœ‰é£é™©ï¼ŒæŠ•èµ„éœ€è°¨æ…ã€‚
